.TH EPTS "1" "May 2018" "epts VERSION" "User Commands"
.SH NAME
epts \- create points and Bezier curves/splines
.SH SYNOPTSIS
.B epts
.br
.B epts
[\fI\,SCROPTION\/\fR]...
.B \-\-image
.I IFILE
.br
.B epts
[\fI\,SCROPTION\/\fR]... \fB\-\-script \fI VNAME \fR[\fI\,SOPTION\/\fR]... [\fI\,SFILE\/\fR]...
.br
.B epts
[\fI\,SCROPTION\/\fR]... [\fI\,TOPTION\/\fR]... [\fI\,EFILE\/\fR]
.br
.SH DESCRIPTION
EPTS (Edit PoinTS) is a special-purpose graphics editor. Its purpose
is to make it easy to take a background, typically an image, overlay a
series of points or curves on top of it, and then scale and/or
translate the positions of the points and curves so that the locations
of the points or control points are expressed in a specific coordinate
system.
.PP
With no arguments, EPTS assumes the background is an image and will
ask the user for an image file. For commands that specify an image
file
.I IFILE
explicitly, that file will be used as the background.  For commands
that specify an EPTS file
.I EFILE
explicitly, the state of a previously saved session will be restored.
In this case, the current working directory will be set to the
directory containing the file
.IR EFILE .
.SH OPTIONS
.PP
There are three types of options.
An option referred to as
.I SOPTION
in the synopsis is an option that is used to configure EPTS to
run one or more scripts that will the background image.  An option
referred to as
.I TOPTION
in the synopsis is an option that is used to configure ETPS for
template processing.
An option referred to as
.I SCROPTION
in the synopsis is an option that is also used by the
.B scrunner
command. Such options can be used to configure the java virtual machine,
to add additional java archives to the class path, to define or change
various system properties, etc.
.PP
The options that do not fit into well-defined categories are:
following:
.TP
.B \-\-
End of options.
.TP
.B \-\-image
The first and only argument that is not an option is the name of an
image file.
.TP
.BI \-\-port\  PORT
When
.I PORT
is zero (the default) and the user requests to view the manual using
a browser, an embedded web server will be started and a browser window
will be brought up.  The web server will use a system-allocated port
number.  If
.I PORT
is not zero, an embedded web server will be started and configured so
that the file manual.html is available. The URL for this file will be
<http://\fIHOST\fR:\fIPORT\fR/manual.html>, where
.I HOST
is the host name (or IP address) of the system on which EPTS is running.
Valid port numbers range from 1 to 65535 inclusive, although many are
reserved for other purposes or require system privileges.
.TP
.BI \-\-script\  VNAME
The argument
.I VNAME
is the name of a scripting-language variable whose value is an
instance of
.B org.bzdev.anim2d.Animation2D
and that object will be used to create an image. The scripts are used
to configure the object referenced by
.IR VNAME .
.PP
If neither of the options
.B \-\-image
or
.B \-\-script
are present, there should be one file argument that provides the name
of a file containing a saved state.  By convention, this file should
end with the file-name extension
.B epts
(for example,
.BR saved.epts ).
.SH Scripting Options

The options specific to the EPTS command  when scripting is  used directly
are the following:
.TP
.BI \-\-double\  NAME\fB=\fIDVALUE
The argument consists of two parts.
.B NAME
is the name of a scripting-language variable and
.B DVALUE
is a real number that provides the corresponding value for that
variable. The variable will be set before any script is run.
.BI \-\-height\  HEIGHT
The value
.I HEIGHT
is the height in points for an image with one pixel per point that
represents a drawing surface. If not provided, a default of 1024 will
be used.
.TP
.BI \-\-int\  NAME\fB=\fIIVALUE
The argument consists of two parts.
.B NAME
is the name of a scripting-language variable and
.B iVALUE
is an integer that provides the corresponding value for that
variable. The variable will be set before any script is run.
.TP
.BI \-\-string\  NAME\fB=\fISVALUE
The argument consists of two parts.
.B NAME
is the name of a scripting-language variable and
.B SVALUE
is a string that provides the corresponding value for that
variable. The variable will be set before any script is run.
.TP
.BI \-\-width\  WIDTH
The value
.I WIDTH
is the width in points for an image with one pixel per point that
represents a drawing surface. If not provided, a default of 1024 will
be used.
.SH Template Options
The options that may be specified when templates are used are the
following:
.TP
.B \-\-elevate
This flag applies when the
.B \-\-pname
option is used and is ignored otherwise. It will increase the
degree of linear and quadratic Bezier-path segments so that
all segments are cubic segments.
.TP
.BI \-\-fill\  COLOR
This option sets the
.B fill
attribute to
.I COLOR
in an SVG path. It applies to a path specified by the next
.B \-\-pname
option. The value of
.I COLOR
can be any color specification accepted by SVG (the same as those
defined by the CSS2 specification). A value of
.B none
indicates that no color is specified and the path will not be filled.
Named colors are listed at
<https://upload.wikimedia.org/wikipedia/commons/2/2b/SVG_Recognized_color_keyword_names.svg>.
A '#' followed immediately by 6 hexadecimal digits gives the RGB values
(two hexadecimal digits in  that order). One can also use the
expression
.B rgb(\fIR\fB,\fIG\fB,\fIB\fB)
where
.IR R ,
.IR B ,
and
.I G
vary from 0 to 255, or 0% to 100%.
.TP
.BI \-\-fill-rule\  RULE
This option sets the
.B fill-rull
attribute to
.I RULE
in an SVG path. It applies to a path specified by the next
.B \-\-pname
option.
.I RULE
may be the constants
.B nonzero
or
.BR evenodd .
.TP
.BI \-\-flatness\  FLATNESS
This option applies when the
.B \-\-pname
option is used and is ignored otherwise, but must not be used with
the
.B \-\-svg
option. When
.I FLATNESS
is zero, the
.B \-\-limit
option determines the number of times a segment will be partitioned. Otherwise
control points must deviate from a straight line along each segment
by at most the value of
.IR FLATNESS ,
which must not be a negative number.
.TP
.B \-\-gcs
This flag applies when the
.B \-\-pname
option is used and is ignored otherwise, but may not be used with the
.B \-\-svg
option. When set, the coordinates of the path's control points will be
expressed in GCS (Graph Coordinate Space) units.  Otherwise the
control points are given in Java user-space units, where distances are
in points and where the origin is at the upper-left corner of the
image or frame, with the positive X axis pointing right and the
positive Y axis pointing down. In GCS units, by contrast, the X axis
points right, the Y axis points down, and the scale is user-defined,
with the origin placed anywhere on or off the image or frame as
desired.
.TP
.BI \-\-limit\  LIMIT
This flag applies when the
.B \-\-pname
option is used and is ignored otherwise. This parameter limits the
amount of recursion used when paths are split to meet a flatness
criteria. When
.I LIMIT
is zero, paths will not be partitioned.
.TP
.BI \-\-map\  MAPFILE
The file
.I MAPFILE
must contain a series of lines, each starting with the token
.BR MOVE_TO ,
.BR SPLINE ,
.BR CONTROL ,
.BR SEG_END ,
or
.BR CLOSE .
A replacement for the token, separated from the token by whitespace,
continues to the end of the line. Any whitespace surrounding the
replacement is removed. The mapping can be used to print the types
of points along a path using a custom string instead of the defaults,
which are based on enumeration constants. The map will set the value
of a key whose name is
.B atype
for use by template processors.
.TP
.BI \-o\  OUTFILE
This option specifies the output file for template processing, and
if missing template-processing will not occur. If the value of
.I OUTFILE
is
.B \-
then standard output is used.  Template processing requires that
a template be specified with the
.B \-\-template
option and one may optionally provide a map using the
.B \-\-map
option when the
.B \-\-pname
option is not used. When the
.B \-o
option is used, EPTS operates in batch mode, and its input file should
be an EPTS file (one with the file extension "epts"). EPTS files are
created by EPTS when its "Save" menu item is used.
.TP
.BI \-\-pname\  PNAME
This option's argument
.I PNAME
provides the name of a variable that names a path.  When this option
is provided, a path-iterator template must be used and the keymap is
the path-iterator keymap, not the table keymap, as described by the
manual page
.BR epts (5)
and by the on-line manual for
.BR epts .
This keymap describes a path as a series of straight-line segments,
quadratic Bezier curves, or cubic Bezier curves. Segments starting or
terminating with a spline point are converted to cubic Bezier curves.
When the
.B \-\-svg
option is used,
.I PNAME
may consist of an identifier, immediately followed by a ":", in turn
followed by a series of comma-separated path names.  This in effect
creates a path with a new name that is a concatenation of paths specified
in EPTS's table. The main use of this variant is to create shapes that
may have holes in them. The attributes
.BR \-\-fill ,
.BR \-\-fillRule ,
.BR \-\-stroke ,
and
.B \-\-stroke-width
that are used are the ones between the current
.B \-\-pname
option and any preceding
.B \-\-pname
option, or the start of the command if there is no preceding
.B \-\-pname
option. After a
.B \-\-pname
these fill and stroke options are reset to their defaults for use
by following
.B \-\-pname
options.
.TP
.B \-\-straight
This flag applies when the
.B \-\-pname
option is used and is ignored otherwise. When set, the path will be
flattened and converted to straight-line segments.
.TP
.BI \-\-stroke\  COLOR
This option sets the
.B stroke
attribute to
.I COLOR
in an SVG path. It applies to a path specified by the next
.B \-\-pname
option. The value of
.I COLOR
can be any color specification accepted by SVG (the same as those
defined by the CSS2 specification). A value of
.B none
indicates that no color is specified and the path will not be drawn.
Named colors are listed at
.br
<https://upload.wikimedia.org/wikipedia/commons/2/2b/
.br
SVG_Recognized_color_keyword_names.svg>.
.br
A '#' followed immediately by 6 hexadecimal digits gives the RGB values
(two hexadecimal digits in  that order). One can also use the
expression
.B rgb(\fIR\fB,\fIG\fB,\fIB\fB)
where
.IR R ,
.IR B ,
and
.I G
vary from 0 to 255, or 0% to 100%.
.TP
.BI \-\-stroke-width\  WIDTH
This option sets the
.B stroke-width
attribute to
.I WIDTH
in an SVG path. It applies to a path specified by the next
.B \-\-pname
option. The value of
.I WIDTH
is any width acceptable to SVG: a number possibly followed by a unit
or a '%' symbol.
.TP
.B \-\-svg
This option, if present, must precede all
.B \-\-pname
options.  It indicates that the output will be an SVG (Scaleable
Vector Graphics) file.  The
.BR \-\-template ,
.BR \-\-flatness ,
.BR \-\-straight ,
and/or
.B \-\-elevate
options must not be used with this option.
.TP
.BI \-\-template: RESOURCE
This option is a shortcut for the option
.BI \-\-template\ sresource: RESOURCE
as built-in templates are a common case.
.TP
.BI \-\-template\  TFILE
The output will be formated based on a template provided by the
file or URL
.IR TFILE .
The format of the template file depends on whether or not the
.B \-\-pname
flag has been set: when set, a path-iterator template must be used;
otherwise a table template must be used. There are a number of
built-in templates whose URLs start with the protocol "sresource"
For table templates, these are <sresource:ECMAScriptLayers>,
<sresource:ECMAScriptLayerPaths>,
<sresource:EMCAScriptLocations>, <sresource:EMCAScriptPaths>,
and <sresource:ECMAScript.>, where "<" and ">" as usual are not
part of the URLs. For path-iterator templates, the URLs are
<sresource:area>, <sresource:circumference>, <sresource:pathlength>, and
<sresource:SegmentsCSV>. These templates are described below.
.TP
.BI \-\-tname\  TNAME
This option's argument
.I TNAME
provides the name of a variable that names a path.  When this option
is provided, a table template must be used and the keymap is
the table keymap as described by the
manual page
.BR epts (5)
and by the on-line manual for
.BR epts .
.I TNAME
may be an existing identifier for a path or a location in an EPTS table,
or it may consist of an identifier, immediately followed by a ":", in turn
followed by a series of comma-separated path names.  This in effect
creates a path with a new name that is a concatenation of paths specified
in EPTS's table. Before each
.B \-\-tname
option, there may be a
.B \-\-windingRule
option.
.TP
.B \-\-web
This option indicates that a web server will be started and the GUI will
be ignored.  The web server will provide access to the on-line manual.
The
.B \-\-port
option should be used as well and should set the port number to a non-zero
value.
.TP
.BI \-\-windingRule\  RULE
This option, when present, adds a winding rule for use with table
templates when the
.B \-\-tname
option is used, and must precede that option. After a
.B \-\-tname
option is seen, the winding rule removed.  The values of
.I RULE
may be
.B evenodd
or
.BR nonzero ,
the same names as used by the
.B \-\-fillRule
option that is used with the
.B \-\-svg
option. The
.B \-\-windingRule
option sets a template-table keymap directive as described in the
documentation for
.BR epts (5)
and in the on-line manual. It is an error to use this option when a
.B \-\-tname
option is not present or when this option does not precede a
.B \-\-tname
option.
.SH SCRUNNER OPTIONS
.PP
Most of the options EPTS supports are ones that are shared with the
program
.BR scrunner .
Unless an exceedingly large image file is used or a custom image
format has to be supported, these are generally not needed when the
background is an image.  The
.B scrunner
options that are supported are:
.TP
.BI \-\-codebase\  URLPATH
Defines directories and jar files to a class path.
.I URLPATH
may be a URL giving the location of the classes or a path name in the
local file system.  The character "|" is used as a path separator, with
the sequence "||" interpreted as a literal "|", so that for an odd number
of "|" characters in a row, only the final one is treated as a path separator.
If file name must start with "|", use a "file" URL and encode the "|" as
%7C.
If the starting sequence of a path component contains a ":" (the first one if
there are more than one), and that sequence of characters is syntactically
valid at the start of a URL, the path component is treated as a URL. Otherwise
it is a file name.  This rule implies that Windows file names such as
C:mycode.jar will be confused with a URL, so a URL should be used instead.
If a file name is not absolute, it is interpreted
relative to the current working directory. Multiple codebase options may be
provided (to improve readability).
Multiple
.B \-\-codebase
options are allowed. For file names, a leading "~" followed by the
name separator ("/" for Unix) is expanded to the user\'s home
directory, a file name consisting of only "~" is replaced with the
user\'s home directory, a leading "~~" is replaced with "~", and a
leading "..." followed by the name separator ("/" for Unix) is
replaced by the directory in which the BZDev class library's JAR file
is located.
.TP
.BI \-D NAME\fB=\fIVALUE
Define the name of a Java property and give it a value.  See the java
command for details.  The syntax for this argument is the same as that
defined for the similarly named option for the
.B java
command.  The properties "java.system.class.loader", "java.security.manager",
"scrunner.sysconf", and "scrunner.usrconf" cannot be altered by this
option (or the corresponding
.B \-J
option).  If those must be changed, add a
.B \-D
option before the
.B \-jar
option in the
.B scrunner
shell script (or alternatively, create a new script).
.TP
.B \-\-dryrun
Prints the java command that would be executed but does not actually
execute it.
.BI \-J \-JOPTION
Causes a single-argument option
.I \-JOPTION
to be used by the java launcher that
.B epts
invokes.
.TP
.BI \-L\  LANGUAGE
Specifies the scripting language
.I LANGUAGE
 in use.
.SH BUILT-IN TEMPLATES
EPTS includes several templates, which can be grouped into two categories:
table templates and path-iterator templates.  A template must be a table
template when the
.B \-\-template
option is used and the
.B \-\-pname
option is not used.  If the
.B \-\-template
option is used and the
.B \-\-pname
is used, the template should be a path-iterator template.
.PP
The table templates are the following:
.TP
.B sresource:ECMAScript
This option will print the information included in the EPTS table. Each
path or location is represented by an ECMAScript variable. For locations,
the value assigned to the variable is an object whose properties
.B x and
.B y
provide the coordinates of the point. For paths, the value assigned
to a variable is an array of objects, each providing the properties
.BR type ,
.BR x ,
and
.BR y .  The value for
.B type
is a string and the values
for
.B x
and
.B y
are numbers giving coordinates. The values for
.B type
are
.BR "CLOSE" ,
.BR "MOVE_TO" ,
.BR "SEG_END" ,
.BR "CONTROL" ,
or
.BR "SPLINE" .
The units for
.B x
and
.B y
are graph-coordinate-space units. One may use the
.B \-\-tname
option to include only specific paths and optionally to use a new variable name
that represents a single path or the concatenation of multiple paths.
The list of objects provided can be used to configure instance of the
Java class
.BR org.bzdev.AnimationPath2DFactory .
.TP
.B sresource:ECMAScriptLayers
This option will print the information included in the EPTS
table. Each path is represented by an ECMAScript variable. Location
entries are ignored.  For paths, the value assigned to a variable is
an array of objects, all providing the property
.BR type ,
and most providing the properties
.B x
and
.BR y .
The value for
.B type
is a string and the values for
.B x and
.B y
are numbers giving coordinates. The values for
.B type are
.BR "PATH_START" ,
.BR "SEG_CLOSE" ,
.BR "MOVE_TO" ,
.BR "SEG_END",
.BR "CONTROL_POINT",
.BR "SPLINE_POINT" ,
and
.BR "PATH_END" .
The units for
.B x and
.B y
are graph-coordinate-space units. For the types
.BR "PATH_START" ,
.BR "SEG_CLOSE" ,
and
.BR "PATH_END",
the "x" and "y" properties are omitted.
One may use the
.B \-\-tname
option to include only specific paths and optionally to use a new
variable name that represents a single path or the concatenation of
multiple paths. When the
.B \-\-tname
option is used, a
.B windingRule
property may be present in objects whose
.B type
property is
.B "PATH_START".
This template differs from the
.B sresource:ECMAScript
template in that the list of objects generated are ones that can be
used to create animation layers using a factory, as described in the
documentation for
.BR org.bzdev.anim2d.AnimationLayer2DFactory .
.TP
.B sresource:ECMAScriptLayerPaths
This option provides the same objects as produced
by the
.B sresource:ECMAScriptLayers
except that the objects whose
.B type
properties have the values
.B "PATH_START"
and
.B "PATH_END"
are omitted.
.TP
.B sresource:ECMAScriptLocations
This template provides the same ECMAScript statements that the
.B sresource:ECMAScript
template produces, but only locations are included, not paths.
.TP
.B sresource:ECMAScriptPaths
This template provides the same ECMAScript statements that the
.B sresource:ECMAScript
template produces, but only paths are included, not locations.
.PP
The path-iterator templates are the following:
.TP
.B sresource:area
This template requires the use of a
.B \-\-pname
option to specify a path name, or to create a new path that is the
concatenation of several existing paths.  It provides the area
enclosed by the path; "NaN" if the path contains any open segments. If
the command was run with the
.B \-\-gcs
option, the units are graph-coordinate-space units; otherwise they are
user-space units.
.TP
.B sresource:circumference
This template requires the use of a
.B \-\-pname
option to specify a path name, or to create a new path that is the
concatenation of several existing paths.  It provides the
circumference of the area enclosed by the path; "NaN" if the path
contains any open segments. If the command was run with the
.B \-\-gcs
option, the units are graph-coordinate-space units; otherwise they are
user-space units.
.TP
.B sresource:pathlength
This template requires the use of a
.B \-\-pname
option to specify a path name, or to create a new path that is the
concatenation of several existing paths.  It provides the
path length, summed over all segments making up the path. If the command was run with the
.B \-\-gcs
option, the units are graph-coordinate-space units; otherwise they are
user-space units.

.TP
.B sresource:SegmentsCSV
This template requires the use of a
.B pname
option to specify a path name, or to create a new path that is the
concatenation of several existing paths.  The template will create its
out in CSV (Comma Separated Values) format, describing the specified
path. The name of the path will not appear in the output.
The CSV values contain 7 columns, some of which may be empty.
The first is
.BR type ,
whose value can be
.BR SEG_CLOSE ,
.BR SEG_CUBICTO ,
.BR SEG_LINETO ,
.BR SEG_MOVETO ,
or
.BR SEG_QUADTO ,
matching names defined by the class
.BR java.awt.geom.PathIterator .
The remaining values are
.BR x0 ,
.BR y0 ,
.BR x1 ,
.BR y1 ,
.BR x2 ,
and
.BR y2 .
The values for these are numbers or empty strings.
.SH FILES
.TP
.I /etc/bzdev/scrunner.conf\ \fRor\fI\ /etc/opt/bzdev/scrunner.conf
System configuration file that allows a specific Java launcher, class-path
entries, and property definitions to be used. The form starting with
/etc/opt may be used on some systems (e.g. Solaris).
.TP
.I ~/.config/bzdev/scrunner.conf
User configuration file that allows a specific Java launcher, class-path
entries, and property definitions to be used.  property definitions in this
file override those in the system configuration file.
.SH SEE ALSO
.BR scrunner (1)
.br
.BR scrunner.conf (5)
.br
.BR epts (5)

\"  LocalWords:  EPTS epts Bezier SYNOPTSIS fI SCROPTION fR EFILE br
\"  LocalWords:  IFILE PoinTS scrunner TP html MAPFILE SEG whitespace
\"  LocalWords:  atype TFILE formated OUTFILE codebase URLPATH fB SVG
\"  LocalWords:  fIVALUE sysconf usrconf dryrun JOPTION fRor Solaris
\"  LocalWords:  config conf VNAME SOPTION SFILE TOPTION ETPS DVALUE
\"  LocalWords:  fIDVALUE fIIVALUE iVALUE fISVALUE SVALUE pname CSS
\"  LocalWords:  RGB rgb fIR fIG fIB rull evenodd svg gcs keymap NaN
\"  LocalWords:  EPTS's fillRule Scaleable sresource ECMAScriptLayers
\"  LocalWords:  ECMAScriptLayerPaths EMCAScriptLocations pathlength
\"  LocalWords:  EMCAScriptPaths SegmentsCSV tname TNAME windingRule
\"  LocalWords:  BZDev ECMAScriptLocations ECMAScriptPaths CSV LINETO
\"  LocalWords:  CUBICTO MOVETO QUADTO
