<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<TITLE>EPTS Manual</TITLE>
</HEAD>
<BODY>
  <CENTER><FONT size="+3"><B>EPTS Manual</B></FONT></CENTER>
<BR>
<BR>
<H1><A name="intro">Introduction</A></H1>

EPTS (Edit PoinTS) is a special-purpose graphics editor. Its purpose
is to make it easy to take a background, typically an image, overlay a
series of points or curves on top of it, and then scale and/or
translate the positions of the points and curves so that the locations
of the points or control points are expressed in a specific coordinate
system.  Because EPTS is designed to support a specific set of tasks,
there are a large number of keyboard shortcuts.  It also uses a
template processor that makes it relatively easy to display paths
textually in a variety of formats, including user-defined formats.
Command-line options used with templates make it easy to use EPTS as
part of a 'build' environment (Java programs such as ANT or the
traditional Unix/Linux use of Makefiles).
<P>
When using the BZDev class library's <CODE>graphs</CODE>
and <CODE>anim2d</CODE> packages, there are three coordinate systems
that are used:
<UL>
  <LI> the standard Java user-space coordinates, which measures
    distances in units of "points" (1/72 inches) and where the
    positive X direction points left and the positive Y direction
    points down. Without any explicit scaling, the JRE (Java Runtime
    Environment) will scale images so that one pixel covers a square
    that is 1 point by 1 point in size. This may represent several
    pixels on a display or output device (e.g., a high-resolution
    printer).  User-space coordinates are floating point numbers.
    As a result, if an output device contains 4 pixels for each
    1x1 point square, and the image is scaled down by a factor of 2,
    there will be no degradation in image quality.
  <LI> image space coordinates, in which one unit corresponds to a
    pixel of an image. The BZDev graphs package and the anim2d package
    will specify if an image, before scaling, would be rendered so
    that one pixel's height and width correspond to one unit in either
    user space or graph coordinate space. EPTS assumes that graph
    coordinate space was chosen, and allows an appropriate scale
    factor to be defined so that a distance in image space will be
    mapped to a corresponding distance in graph coordinate space.
  <LI> GCS (Graph Coordinate Space) coordinates, in which distances are
    measured in application-specific coordinates (e.g., meters) and
    where the positive X direction points left and the positive Y
    direction points up. EPTS allows distances to be specified in either
    custom units or meters.  If custom units are not used, all other
    units will be converted to meters.
</UL>
EPTS will display an image and allow one to overlay this image with
points and B&eacute;zier curves, expressing their locations and control
points in graph coordinate space units. It will also allow one to measure
the distance between points in either image space or graph coordinate space
units.

<H1><A name="menus">The menu bar</A></H1>

The EPTS window provides a menu bar containing 6 menus:
<UL>
  <LI> the <A HREF="#fileMenu"><CODE>File</CODE></A> menu.
  <LI> the <A HREF="#editMenu"><CODE>Edit</CODE></A> menu.
  <LI> the <A HREF="#zoomMenu"><CODE>Zoom</CODE></A> menu.
  <LI> the <A HREF="#measureMenu"<CODE>Measure Distance</CODE>></A> menu.
  <LI> the <A HREF="#toolsMenu"><CODE>Tools</CODE></A> menu.
  <LI> the <A HREF="#helpMenu"><CODE>Help</CODE></A> menu.
</UL>
These menus are described below. The following figure shows the menus
above a minimally-sized canvas:
<BR>
<BR>
<CENTER><IMG src="menubar.png"></CENTER>
<BR>

<H2><A name="fileMenu">The File menu</A></H2>

The <code>File</code> menu contains the following items:
<UL>
  <LI><code>Quit</code>. Choosing this menu item causes the program to
    exit.
  <LI><code>Save</code>. Choosing this menu item causes the program to
    be saved.
  <LI><code>Save As</code>. Choosing this menu item causes the program to
    be saved with a new file name. This new file will become the default
    file name for the <code>Save</code> menu item.
  <LI><A name="config"><code>Configure CGS</code></A>. Choosing this
    menu item will open a dialog box for configuring graph coordinate
    space. This dialog box allows one to set a distance in user-spaced
    units and the corresponding distance in graph coordinate space
    units. The units for graph coordinate space are either custom
    units (arbitrary units defined by the user) or meters. If another
    unit is specified, it's value will be converted to
    meters. Canceling the dialog box will restore the values to those
    that existed just before the dialog box was opened. Users may
    specify a reference point (<CODE>LOWER_LEFT</CODE>,
    <CODE>LOWER_CENTER</CODE>, <CODE>LOWER_RIGHT</CODE>,
    <CODE>CENTER_LEFT</CODE>, <CODE>CENTER</CODE>, <CODE>CENTER_RIGHT</CODE>,
    <CODE>UPPER_LEFT</CODE>, <CODE>UPPER_CENTER</CODE>, or
    <CODE>UPPER_RIGHT</CODE>) and the graph-coordinate-space
    coordinates for the reference point in either custom units or
    meters.  When explicitly configured, the coordinates for the
    reference point will typically be (0.0, 0.0).  When scripting is
    used, The reference point is always set to <CODE>LOWER_LEFT</CODE>
    and the reference point coordinates will be set to match the
    coordinates used by the script. For example, when configuring EPTS
    for an image, the dialog box shown below sets the scale factors so
    that a distance of 40.0 in image space corresponds to a distance
    of 12 feet (converted to meters) in graph coordinate space:
    <BR>
    <BR>
    <CENTER><IMG src="drawing5.png"></CENTER>
    <BR>
    The coordinates - (0.0, 0.0) in the figure above - are in graph
    coordinate space and correspond to the lower-left corner of an
    image, with the positive X axis pointing towards the lower-right
    corner of the image and the positive Y axis pointing towards the
    upper-left corner of the image.
  <LI><code>Print Table</code>. Choosing this menu item will open
    a 'print' dialog box to print the table.
</UL>

<H2><A name="editMenu">The Edit menu</A></H2>

The <code>Edit</code> menu contains the following items:
<UL>
  <LI><B><CODE>Undo point insertion</CODE></B>. This essentially removes
    the last row (two rows for a closed path) from the table. If
    a previous path is extended via the <CODE>Tools</CODE> menu's
    <CODE>Add to B&eacute;zier Path</CODE> item, that path will be
    moved to the end of the table. While creating a path, this option
    undoes the last change.
  <LI><B><CODE>Copy table as ECMAScript</CODE></B>. This option copies the
    table to the clipboard after formatting it as a series of
    ECMA script statements.
  <LI><B><CODE>Set the location format</CODE></B>. This is a list of
    radio buttons:
    <UL>
      <LI><B><CODE>Location as (X,Y)</CODE></B>.
      <LI><B><CODE>Location as x: X, y: Y}</CODE></B>.
      <LI><B><CODE>Location as {x: X, y: Y}</CODE></B>.
      <LI><B><CODE>Location as V = {x: X, y: Y};</CODE></B>.
    </UL>
    The format is that shown by the menu-item name, excluding the
    string "Location as ", where X is the X coordinate of the point,
    Y is the Y coordinate of the point, and V is the name of a
    variable to which the object "{x: X, y: Y}" will be assigned.
  <LI><A name="dragImage"><CODE>Drag-Image Mode</CODE></A>. This menu
    item determines if dragging the mouse drags the image..  While one
    can alternatively press the ALT key and then press the primary
    mouse button, some window systems have shortcuts that process this
    combination and do not pass it on to applications. The image will
    not be dragged when this mode is in effect and a distance is being
    measured or a path (or point) is being created or modified.
</UL>

<H2><A name="zoomMenu">The Zoom menu</A></H2>
The <code>Zoom</code> menu contains the following items:
<UL>
  <LI><B><CODE>Reset</CODE></B>. This option resets the image size so that
    one pixel on the image takes up one point on the screen.
  <LI><B><CODE>Zoom in</CODE></B>. This option increases the zoom factor by a
  factor of 2.
  <LI><B><CODE>Zoom out</CODE></B>. This option decreases the zoom factor by a
    factor of 2.
</UL>
The remaining items represent specific zoom factors numerically. The
number of these entries depends on the image size.

<H2><A name="measureMenu">The Measure-Distance menu</A></H2>
The <CODE>Measure Distance</CODE> menu contains the following items:
<UL>
  <LI><B><CODE>Image space distance</CODE></B>. This option measures distances
    in image-space units. This is particularly useful just before using the
    the <CODE>File</CODE> menu's <CODE>Configure GCS</CODE> option as the
    valued measured will be automatically copied to the clipboard and
    can be pasted into the the user-space-distance field which the
    <CODE>Configure GCS</CODE> dialog box will show.
  <LI><B><CODE>GCS distance</CODE></B>. This option measures distances in graph
    coordinate space units. Until the <CODE>File</CODE> menu's
    <CODE>Configure GCS</CODE> option is used, the ratio of GCS distances
    to the corresponding image-space distances is 1 to 1.
</UL>
When either of these options is selected, the cursor will change to a
cross-hair cursor.  One should then click on a starting point, followed by
and ending point. Text will appear above the image providing instructions.
In both cases, the distance measured will be displayed an automatically
copied to the system clipboard so it can be pasted into any window
or component that will accept text.

<H2><A name="toolsMenu">The Tools menu</A></H2>

The <CODE>Tools</CODE> menu allows points and curves to be created and
displayed in textual form. This menu contains the following items:
<UL>
  <LI><B><CODE>Show PointTable</CODE></B>. Show a table containing
    each location and curve, including the curve segments, with
    control points for quadratic and cubic B&eacute; segments and with
    knots for spline segments. The only points contained in this table
    are those created with a variable name.  All curves are included
    because all of the curves have a variable name. As an example
    corresponding to an <A href="drawing2">example shown below</A>, a
    table for a cubic B&eacute;zier curve with two control points is
    the following:
    <BR>
    <BR>
    <CENTER><IMG src="table2.png"></CENTER>
    <BR>
  <LI><B><CODE>Create a Point</CODE></B>. This option will create a new,
    isolated point. It will appear in the table if given a name.
    A description of this point, in a format set by <CODE>Edit</CODE>
    menu options, will be copied to the clipboard. Selecting an option
    other than the one specifying a variable name will result in the
    point not appearing in the table. If a variable name is requested
    and the variable name is left as an empty string, a new variable
    name will be generated, starting the string "pt" and followed by
    a number (e.g., <code>pt7</code>.)
  <LI><B><CODE>Create a B&eacute;zier Path</CODE></B>. A new path will be
    created. A dialog box will ask for a variable name for the path,
    and the cursor will change to a cross-hair cursor, and the user
    should select the initial point on the curve.  The point type
    shown in the table is <CODE>MOVE_TO</CODE> - only one such point
    is allowed for each curve. If a variable name is requested and the
    variable name is left as an empty string, a new variable name will
    be generated, starting the string "path" and followed by a number
    (e.g., <CODE>path24</CODE>.)
  <LI><B><CODE>Add to a B&eacute;zier Path</CODE></B>. The user will be asked to
    select the name of a path, and adding points to the path will then
    be possible.
  <LI>A series of radio buttons specifying the type for
      the next point along a curve:
    <UL>
      <LI><B><CODE>Spline Point(s)</CODE></B>. This option indicates that the
	next point clicked will be a knot on a segment described by a
	spline. The path will be a smooth path going through each of
	the specified knots. While the spline is actually a sequence
	of cubic B&eacute;zier curve segments, the inner control
	points for those segments are not shown as these are
	implicitly computed. Spline points are shown as solid black
	circles with white borders. For example, the following figure
	shows an EPTS window containing a closed curve consisting of
	spline points (how to close a curve is described below):
	<BR>
	<BR>
	<CENTER><IMG src="drawing1.png"></CENTER>
	<BR>
      <LI><B><CODE>Control Point(s)</CODE></B>. This option indicates that
	the next point is a control point. There can be at most two
	control points in a row. Control points are as solid
	black squares with white borders. For example, the following
	figure shows an EPTS window containing an open curve with two
	internal control points:
	<BR>
	<BR>
	<CENTER><IMG src="drawing2.png"></CENTER>
	<BR>
	<BR>
	In the figure, the tangent lines leading to the control points
	shown as squares are not part of the curve itself.
      <LI><B><CODE>End Curve/Line Segment</CODE></B>. This option indicates
	that the next point is the end of a segment. A segment with no
	intermediate control or spline points is a straight-line segment.
	Like spline points, the end-of-segment points are shown as
	black circles with white borders.
    </UL>
  <LI>Options for ending a path.
    <UL>
      <LI><B><CODE>Loop</CODE></B>. The path will be closed by connecting the
	last point entered to the first point on the path.  A loop
	must have an end-of-segment point as the last point entered
	unless all the points except the first point have a type
	equal to <CODE>SPLINE</CODE>.
      <LI><B><CODE>Path Ended</CODE></B>. This option ends the current path
	without closing it.
    </UL>
    Menu items that are not applicable are disabled.
</UL>

<H2><A name ="helpMenu">The Help menu</A></H2>
The <CODE>Help</CODE> menu provides several ways of viewing a
manual. This menu contains the following items:
<UL>
  <LI><B><CODE>Manual</CODE></B>. This option shows the manual in a window
    that contains two panes: one with a table of contents and the
    other with the manual itself.
  <LI><B><CODE>Print Manual</CODE></B>. This option opens a printer dialog
    box and allows the user to produce a printed copy of the manual.
  <LI><B><CODE>Browser</CODE></B>. This option opens the system's default
    browser and displays the manual in it. As a side effect, an embedded
    web server will also be started, and that web server can be accessed
    by other users.
</UL>

<H1><A name="mouse">Using the mouse</A></H1>

There are several combinations of mouse buttons and modifier keys that
may be used, mostly to create or modify points (locations, control
points, segment ending points, or spline points), all shown as filled
circles overlayed on the image):
<UL>
  <LI> ALT key and primary mouse button pressed. The image can be
    dragged, and scrollbars will move in the opposite direction to
    that in which the cursor moves. The image, however, cannot be
    dragged beyond the range that the scrollbars support. If a window
    system has a short cut that uses the same key-mouse combination,
    the window system's behavior may occur instead. In this case, use
    the <A href="#dragImage">drag-image mode</A> Edit menu option to
    put EPTS into the desired state.
  <LI> Control Key and primary mouse button pressed. This combination
    is used while creating a path or extending a path.  The mouse must
    be positioned over a point when the left button is pressed. The
    point can then be dragged to a new location.  The selected point
    will have a circle around it. If a window system has a short cut
    that uses the same key-mouse combination, the window system's
    behavior may occur instead.
  <LI> No keys but the primary mouse button clicked. When a cross-hair
    cursor is shown, a point will be added, either an isolated point
    or an additional point along a curve. When the normal 'arrow' cursor
    is shown, this option allows one to select or deselect a point.
    A point is selected when the mouse is clicked while positioned over
    it. A point is deselected by clicking on an area of the image that does
    not contain a point. When a point is selected, a ring is drawn around it.
  <LI> A popup menu is requested. The key sequence is system dependent.
    On X-windows systems, one typically presses the button on the
    opposite side of the mouse from the primary button.
    In the Java look and feel, clicking the this mouse button will make
    the popup menu stay up. Popup menus are context sensitive. They can
    appear when a point has been selected or when a cross-hair cursor
    is shown and there is a previous point to modified.
</UL>
In most configurations, the primary mouse button is the left mouse
button. Windows systems, however, may give the user the option of
changing this.

<H2><A name="popup">Popup Menus</A></H2>

There are two popup menus that can be displayed. As stated above,
these are context-sensitive.

When a path is being created or extended, and a point has been added,
a popup menu is available that will allow one to change the type of
the last point entered.  The options are to change a mode to
<CODE>SEG_END</CODE>, <CODE>SPLINE</CODE>, or <CODE>CONTROL</CODE>.
Only the options that are applicable given the types of the
previous points on the path will be enabled. For example:
<BR>
<BR>
<CENTER><IMG src="drawing3.png"></CENTER>
<BR>
<P>
When a path is not being created or extended, but a point on a path
has been selected, a popup menu is also available. This menu provides
the following options:
<UL>
  <LI><B><CODE>Delete Point</CODE></B>. This option deletes the selected point
    from the path.
  <LI><B><CODE>Change Point Type</CODE></B>. This option allows one to change
    the type of the selected point. The choice types is dependent on
    the types of the surrounding points.
  <LI><B><CODE>Insert Before Point</CODE></B>. This option allows one to insert
    a new point into a path before the selected point.
  <LI><B><CODE>Insert After Point</CODE></B>.  This option allows one to insert
    a new point into a path after the selected point.
  <LI><B><CODE>Break Loop</CODE></B>. This option turns a closed path into an
    open path.
  <LI><B><CODE>Extend Path</CODE></B>. This option allows one to add new
    points to a path. It will also re-order the table (for reasons
    of convenience, when a path is extended, it is moved to the end
    of the table).
</UL>
The only popup-menu items that are enabled are those that are applicable
given the current state of the curve. For example,
<BR>
<BR>
<CENTER><IMG src="drawing4.png"></CENTER>
<BR>
Points that are selected are denoted by another circle or square
surrounding the selected point.

<H1><A name="shortcuts">Keyboard shortcuts</A></H1>

Some shortcuts apply regardless of the current mode:
<UL>
  <LI> Control-Q. This will cause EPTS to terminate.
  <LI> Control-P. This will print the table.
  <LI> Control-Z. This is an "undo" operation.
  <LI> Control-Minus. Zoom out.
  <LI> Control-Plus.  Zoom in.
  <LI> Control-0. Restore the zoom factor to the original size. (1 to 1).
  <LI> Control-T. Display the table in a separate window.
  <LI> Control-Right-Arrow. Move the horizontal scroll bar to the right.
  <LI> Control-Left-Arrow. Move the horizontal scroll bar to the left.
  <LI> Control-Up-Arrow. Move the vertical scroll bar up.
  <LI> Control-Down-Arrow. Move the vertical scroll bar down.
  <LI> Alt-A. Append points to a B&eacute;zier path.
  <LI> Alt-D. This toggles whether
    <A href="#dragImage">drag-image mode</A> is in effect, and can
    be used when a window system provides shortcuts that use the
    ALT key with the primary mouse button.
  <LI> Alt-I. Measure the image-space distance between two points.
  <LI> Alt-G. Measure the graph-coordinate-space distance between two
    points.  To provide a meaningful distance, graph coordinate space
    must be configured first. The
    <A href="#config"><CODE>Configure CGS</CODE></A> menu item allows
    graph coordinate space to be configured.
  <LI> Alt-P. Add an isolated point.  The user will be asked to supply
    a variable name that has not been used before. If that variable
    name is not provided or consists of just whitespace, a name will
    be generated.  A generated name starts with the
    string <CODE>pt</CODE> and ends with a positive integer.
  <LI> Alt-B. Add a B&eacute;zier path. The user will be asked to
    supply a variable name that has not been used before. If that
    variable name is not provided or consists of just whitespace, a
    name will be generated.  A generated name starts with the
    string <CODE>path</CODE> and ends with a positive integer.
</UL>

By contrast, some key combinations apply only when adding a point to
a path or creating an isolated point at a specific location:
<UL>
  <LI> Right-Arrow. When this key is clicked, a cross-hair cursor will
    move to the right.
  <LI> Left-Arrow.  When this key is clicked, a cross-hair cursor will
    move to the left.
  <LI> Up-Arrow.  When this key is clicked, a cross-hair cursor will
    move to up.
  <LI> Down-Arrow. When this key is clicked, a cross-hair cursor will
    move to down.
  <LI> S. When the S key is pressed (without a modifier key, regardless
    of whether the caps-lock key is in use), the next point will be
    a spline point. If a spline point is not allowed, the keystroke
    will be ignored.
  <LI> C. When the C key is pressed (without a modifier key, regardless
    of whether the caps-lock key is in use), the next point will be a
    control point.  If a control point is not allowed, the keystroke
    will be ignored.
  <LI> E. When the E key is pressed (without a modifier key, regardless
    of whether the caps-lock key is in use), the next point will be an
    end-of-segment point.
  <LI> L. When the L key is pressed (without a modifier key, regardless
    of whether the caps-lock key is in use), the current path will be
    ended in a loop. This option will be ignored if the last point is
    a control point or if the last point is a spline point and there is
    an end-of-segment point that is already part of the path.
  <LI> Z. When the Z key is pressed (without a modifier key, regardless
    of whether the caps-lock key is in use), the current path will remain
    open and will be ended.  The type of the last point will be changed to
    an end-of-segment point.
</UL>

<H1><A name="templates">Templates</A></H1>

Templates allow output files to be produced in a variety of formats.
A template is specified by using the <CODE>--template</CODE>
command-line option.  The value is either a URI or a file name.
There are a number of built-in templates that are accessible by
using a URI whose scheme is <CODE>sresource</CODE>. These  fit
into two categories: table templates and path-iterator templates.

<H2><A name="builtins">Built-in Templates</A></H2>

The built-in table templates are the following:
<UL>
  <LI><B><CODE>sresource:ECMAScript</CODE></B>.  This option will print the
    information included in the EPTS table. Each path or location is
    represented by an ECMAScript variable. For locations, the value
    assigned to the variable is an object whose properties
    <CODE>x</CODE> and <CODE>y</CODE> provide the coordinates of the
    point. For paths, the value assigned to a variable is an array of
    objects, each providing the properties <CODE>type</CODE>,
    <CODE>x</CODE>, and <CODE>y</CODE>.  The value for
    <CODE>type</CODE> is a string, and the values for <CODE>x</CODE>
    and <CODE>y</CODE> are numbers giving coordinates. The values for
    <CODE>type</CODE> are <CODE>"CLOSE"</CODE>, <CODE>"MOVE_TO"</CODE>,
    <CODE>"SEG_END"</CODE>, <CODE>"CONTROL"</CODE>, or
    <CODE>"SPLINE"</CODE>.  The units for <CODE>x</CODE> and
    <CODE>y</CODE>are graph-coordinate-space units. One may use the
    <CODE>--tname</CODE> option to include only specific paths and
    optionally to use a new variable name that represents a single
    path or the concatenation of multiple paths.  The list of objects
    provided can be used to configure instance of the Java
    class <CODE>org.bzdev.AnimationPath2DFactory</CODE>.
  <LI><B><CODE>sresource:ECMAScriptLayers</CODE></B>.
    This option will print the information included in the EPTS
    table. Each path is represented by an ECMAScript variable. Location
    entries are ignored.  For paths, the value assigned to a variable is
    an array of objects, all providing the property
    <CODE>type</CODE>, and most providing the
    properties <CODE>x</CODE> and <CODE>y</CODE>.  The value for
    <CODE>type</CODE> is a string and the values for <CODE>x</CODE> and
    <CODE>y</CODE> are numbers giving coordinates. The values for
    <CODE>type</CODE> are <CODE>"PATH_START"</CODE>,
    <CODE>"SEG_CLOSE"</CODE>, <CODE>"MOVE_TO"</CODE>,
    <CODE>"SEG_END"</CODE>, <CODE>"CONTROL_POINT"</CODE>,
    <CODE>"SPLINE_POINT"</CODE>, and <CODE>"PATH_END"</CODE>.  The
    units for <CODE>x</CODE> and <CODE>y</CODE> are
    graph-coordinate-space units. For the types
    <CODE>"PATH_START"</CODE>, <CODE>"SEG_CLOSE"</CODE>, and
    <CODE>"PATH_END"</CODE>, the <CODE>x</CODE> and <CODE>y</CODE>
    properties are omitted. One may use the
    <CODE>--tname</CODE> option to include only specific paths and
    optionally to use a new variable name that represents a single
    path or the concatenation of multiple paths. When the
    <CODE>--tname</CODE> option is used, a <CODE>windingRule</CODE>
    property may be present in objects whose <CODE>type</CODE>
    property is <CODE>"PATH_START"</CODE>.
    This template differs from the <CODE>sresource:ECMAScript</CODE>
    template in that the list of objects generated are ones that can be
    used to create animation layers using a factory, as described in the
    documentation for  <CODE>org.bzdev.anim2d.AnimationLayer2DFactory</CODE>.
  <LI><B><CODE>sresource:EMCAScriptLocations</CODE></B>.
    This template provides the same ECMAScript statements that the
    <CODE>sresource:ECMAScript</CODE> template produces, but only
    locations are included, not paths.
  <LI><B><CODE>sresource:ECMAScriptPaths</CODE></B>.
    This template provides the same ECMAScript statements that the
    <CODE>sresource:ECMAScript</CODE> template produces, but only
    paths are included, not locations.
</UL>

The built-in path-iterator templates are
<UL>
  <LI><B><CODE>sresource:area</CODE></B>. This template requires the use of
    a <CODE>--pname</CODE> option to specify a path name, or to create a
    new path that is the concatenation of several existing paths.  It
    provides the area enclosed by the path; "NaN" if the path contains
    any open segments. If the command was run with the
    <CODE>--gcs</CODE> option, the units are graph-coordinate-space
    units; otherwise they are user-space units.
  <LI><B><CODE>sresource:circumference</CODE></B>. This template requires
    the use of a <CODE>--pname</CODE> option to specify a path name, or
    to create a new path that is the concatenation of several existing
    paths.  It provides the circumference the path; "NaN" if the path
    contains any open segments. If the command was run with the
    <CODE>--gcs</CODE> option, the units are graph-coordinate-space
    units; otherwise they are user-space units.
  <LI><B><CODE>sresource:pathlength</CODE></B>. This template requires
    the use of a <CODE>--pname</CODE> option to specify a path name, or
    to create a new path that is the concatenation of several existing
    paths.  It provides the length of the path (the sum of the lengths
    of all its segments). If the command was run with the
    <CODE>--gcs</CODE> option, the units are graph-coordinate-space
    units; otherwise they are user-space units.
  <LI><B><CODE>sresource:SegmentsCSV</CODE></B>.
    This template requires the use of a
    <CODE>--pname</CODE> option to specify a path name, or to create a
    new path that is the concatenation of several existing paths.  The
    template will create its out in CSV (Comma Separated Values)
    format, describing the specified path. The name of the path will
    not appear in the output.  The CSV values contain 7 columns, some
    of which may be empty.  The first is <CODE>type</CODE>,
    whose value can be <CODE>SEG_CLOSE</CODE>, <CODE>SEG_CUBICTO</CODE>,
    <CODE>SEG_LINETO</CODE>, <CODE>SEG_MOVETO</CODE>, or
    <CODE>SEG_QUADTO</CODE>, matching names defined by the class
    <CODE>java.awt.geom.PathIterator</CODE>. The remaining values are
    <CODE>x0</CODE>, <CODE>y0</CODE>, <CODE>x1</CODE>, <CODE>y1</CODE>,
    <CODE>x2</CODE>, and <CODE>y2</CODE>. The values for these are
    numbers or empty strings.
</UL>

<H2><A name="templateSyntax">Template Syntax</A></H2>
<P>
Templates specify an output format for points and paths using the
syntax specified by the Java
class <CODE>org.bzdev.util.TemplateProcessor</CODE>.  Instances of
this class are constructed using a tree consisting of objects whose type
is <CODE>org.bzdev.util.TemplateProcessor.KeyMap</CODE> or
is <CODE>org.bzdev.util.TemplateProcessor.KeyMapList</CODE>. This
tree determines the directives a give template processor supports
and how those directives are used. Each value corresponding to a key
is either a string (<CODE>java.lang.String</CODE>), a <CODE>KeyMap</CODE>,
an array of <CODE>KeyMap</CODE>, or a <CODE>KeyMapList</CODE>. The
keys name directives. When a key's value is a string, the directive is
a simple directive.  Otherwise it is an iterative directive. When the
value of an iterative directive is a single <CODE>KeyMap</CODE>, the
iteration occurs once and this can be used a conditional (provided
when the directive is defined and missing when it is not defined).
<P>
A template contains a mixture of text and directives stored in a text
file. In a template, directives start with the sequence "$(" and end with a
closing ")".  A simple directive contains a variable name and its
value is a string that provides text that will be substituted for the
directive.  For example, the directive "$(varname)" will be replaced
by a string containing a variable name.  The directive "$$" is
replaced with a single dollar sign.  An iterative directive consists
of a name, a colon (":") and a second name. Its value is either a
key map (in which case it is treated like a list with a single value,
or a list or array providing key maps over which one iterates). A
following simple directive containing the second name will then end
the iterative block.
<P>
Directives can be globally defined or can be scoped to apply only
within an iterative block.  When blocks are nested and a directive is
defined at multiple levels, the most recent definition is used.

<H2><A name="tbltemplate">Table Templates</A></H2>
<P>
EPTS provides key maps appropriate for representing its table entries.
for these tables, EPTS defines one global directive: <CODE>items</CODE>,
which is an iterative directive.  This directive iterates through a
list, setting values for the following directives:
<UL>
  <LI><B><CODE>varname</CODE></B>. This is a simple directive defining a
    variable name associated with a location or path.
  <LI><B><CODE>index</CODE></B>. An overall index. This value is incremented
    for each line in the table.
  <LI><B><CODE>vindex</CODE></B>. An variable-name index. This value is
    incremented whenever a variable name changes.
  <LI><B><CODE>location</CODE></B>. This is an iterative directive that
    defines a specific, isolated point. While iterative, each
    definition contains only a single point. Both
    <CODE>location</CODE> and <CODE>pathStatement</CODE> will not
    both be present at a specific iteration, although one of the
    two will be present.
  <LI><B><CODE>pathStatement</CODE></B>. This is an iterative directive
    that defines the control points for a path. While iterative, each
    pathSegment definition contains a single key map as its value. Both
    <CODE>location</CODE> and <CODE>pathStatement</CODE> will not
    both be present at a specific iteration, although one of the
    two will be present.
</UL>
For example,
<BLOCKQUOTE><PRE><CODE>
      $(items:endItems)$(varname)
      $(endItems)
</CODE></PRE></BLOCKQUOTE>
will generate a list of variable names, one per line, for all the
points and paths that are currently defined.
<P>
The value for <CODE>location</CODE> is a key map containing
the following keys describing a point:
<UL>
  <LI><B><CODE>x</CODE></B>. The X coordinate of the point in graph coordinate
    space.
  <LI><B><CODE>y</CODE></B>. The Y coordinate of the point in graph coordinate
    space.
  <LI><B><CODE>xp</CODE></B>. The X coordinate of the point in image space.
  <LI><B><CODE>yp</CODE></B>. The Y coordinate of the point in image space,
    measured from top to bottom(the standard Java convention).
  <LI><B><CODE>ypr</CODE></B>. The Y coordinate of the point in image space
    measured from bottom to  (the reverse of the standard Java convention,
    following the convention used in mathematics instead).
</UL>
<P>
Similarly, the value for <CODE>pathStatement</CODE> is a key map
containing the following directives:
<UL>
  <LI><B><CODE>hasWindingRule</CODE></B>. This is an iterative directive
    what will provide at most a single iteration. When present (i.e.,
    when the iteration count is 1), there is a single directive:
    <CODE>windingRule</CODE>, whose value is <CODE>WIND_EVEN_ODD</CODE>
    or <CODE>WIND_NON_ZERO</CODE>.
  <LI><B><CODE>pathItem</CODE></B>. This is an iterative directive that
    will list a series of objects representing a path.
</UL>
In turn, the <CODE>pathItem</CODE> directive contains the following
directives:
<UL>
  <LI><B><CODE>pindex</CODE></B>. The value is "1" for the initial
    MOVE_TO operation for a path and is incremented for each
    control point, spline point, or end-of-segment point, along
    the path, and for a final 'close' directive if there is one.
  <LI><B><CODE>type</CODE></B>. This is the type of a point or operation
    along the path (<CODE>MOVE_TO</CODE>, <CODE>SPLINE</CODE>,
    <CODE>CONTROL</CODE>, <CODE>SEG_END</CODE>, or <CODE>CLOSE</CODE>).
  <LI><B><CODE>ltype</CODE></B>. This is similar to the <CODE>type</CODE>
    directive, but substitutes <CODE>CONTROL_POINT</CODE> for
    <CODE>CONTROL</CODE>, and <CODE>SPLINE_POINT</CODE>
    for <CODE>SPLINE</CODE>. The directive <CODE>ltype</CODE> is useful
    for configuring an instance of the class
    <CODE>org.bzdev.anim2d.AnimationLayer2DFactory</CODE>.
  <LI><B><CODE>atype</CODE></B>. This is is similar to <CODE>type</CODE> but
    with an alternative value defined by the user via a command-line
    argument that provides the name of a file mapping types to their
    replacement strings.
  <LI><B><CODE>xy</CODE></B>. This is an iterative directive, with 0 or 1
    iterations. It defines the following directives (the same ones
    as defined by the location directive) when the value of
    <CODE>type</CODE>is <CODE>MOVE_TO</CODE>, <CODE>SPLINE</CODE>,
    <CODE>CONTROL</CODE>, or <CODE>SEG_END</CODE>:
    <UL>
      <LI><B><CODE>x</CODE></B>. The X coordinate of the point in graph
	coordinate space.
      <LI><B><CODE>y</CODE></B>. The Y coordinate of the point in graph
	coordinate space.
      <LI><B><CODE>xp</CODE></B>. The X coordinate of the point in image
	space.
      <LI><B><CODE>yp</CODE></B>. The Y coordinate of the point in image
	space, measured from top to bottom (the standard Java
	convention).
      <LI><B><CODE>ypr</CODE></B>. The Y coordinate of the point in image
	space measured from bottom to top (the reverse of the
	standard Java convention, following the convention
	used in mathematics instead).
    </UL>
    When the type is <CODE>CLOSE</CODE>, the <CODE>xy</CODE> directive
    is not defined.
</UL>
<P>
For example, the following template will create a set of statements
suitable for use by ECMAScript (the template EPTS actually uses has
less whitespace so that the output will contain fewer blank lines and
will be indented properly for readability):
<BLOCKQUOTE><PRE><CODE>
  $(items:endItems)
     $(location:endLocation)
        var $(varname) = {x: $(x), y: $(y)};
  $(endLocation)
  $(pathStatement:endPathStatement)
     var $(varname) = [
         $(pathItem:endPathItem)
            {type: "$(type)"
            $(xy:endXY), x: $(x), y: $(y)$(endXY)}$(optcomma)
         $(endPathItem)
        ];
  $(endPathStatement)
$(endItems)
</CODE></PRE></BLOCKQUOTE>

<H2><A name="pitemplates">Path-Iterator Templates</A></H2>

Path-Iterator templates allow one to list the values provided by
Java path iterators.  Command-line options determine the path iterator
to use. The key map contains the following directives:
<UL>
  <LI><B><CODE>area</CODE></B>. This directive contains the area of the
    shape. If constructed from multiple paths, all of these paths must
    be closed paths: otherwise the value will be "NaN". The units are
    either user-space units or GCS units, depending on flags passed to
    <CODE>epts</CODE>. When the <CODE>epts</CODE> command contains the
    <CODE>--gcs</CODE> option, GCS units are used; otherwise
    user-space units are used.
  <LI><B><CODE>circumference</CODE></B>.  This directive contains the
    circumference of the shape. If constructed from multiple paths,
    all of these paths must be closed paths: otherwise the value will
    be "NaN". The units are either user-space units or GCS units,
    depending on flags passed to <CODE>epts</CODE>. When the
    <CODE>epts</CODE> command contains the <CODE>--gcs</CODE> option,
    GCS units are used; otherwise user-space units are used.
  <LI><B><CODE>pathLength</CODE></B>. This directive contains the path length
    for the boundary of a shape, regardless of whether it encloses an
    area.  The units are either user-space units or GCS units,
    depending on flags passed to <CODE>epts</CODE>. When the
    <CODE>epts</CODE> command contains the <CODE>--gcs</CODE> option,
    GCS units are used; otherwise user-space units are used.
  <LI><B><CODE>varname</CODE></B>. This directive provides the name of the
    variable whose value is the path that the following directives
    describe.
  <LI><B><CODE>windingRule</CODE></B>.
    This directive determines the winding rule. Its values are
    either <CODE>WIND_EVEN_ODD</CODE> or <CODE>WIND_NON_ZERO</CODE>.
    <CODE>WIND_EVEN_ODD</CODE> indicates that a point is inside a
    closed path if a ray drawn to infinity crosses path segments an
    odd number of times. <CODE>WIND_NON_ZERO</CODE> indicates that a
    point is inside a closed path if a ray drawn to infinity crosses
    segments drawn in the counterclockwise direction a different
    number of times than segments drawn in the clockwise direction.
  <LI><B><CODE>segments</CODE></B>.
    This is an iterative directive that provides data for a sequence of
    path segments. A <CODE>MOVE_TO</CODE> segment sets the current point
    and the other path segments describe how to extend the path from
    the current point.
</UL>
The following directives can be used within the scope of a
<CODE>segments</CODE> directive:
<UL>
  <LI><B><CODE>type</CODE></B>. This directive is always provided.  Its value
    can be either <CODE>SEG_CLOSE</CODE>, <CODE>SEG_MOVETO</CODE>,
    <CODE>SEG_CUBICTO</CODE>, <CODE>SEG_LINETO</CODE>, or
    <CODE>SEG_QUADTO</CODE>.
  <LI><B><CODE>method</CODE></B>. This directive is always provided.  Its value
    can be either <CODE>closePath</CODE>, <CODE>moveTo</CODE>,
    <CODE>lineTo</CODE>, <CODE>quadTo</CODE>,or <CODE>cubicTo</CODE>.
    These are the names of the Java methods used to construct a path.
  <LI><B><CODE>hasClose</CODE></B>. This is an iterative directive providing
    0 or 1 iterations. When provided, it indicates that the path is to
    be closed, terminating at the position give by the
    last <CODE>MOVETO</CODE> operation.  If necessary, a
    straight-line segment will be added to close the path.
  <LI><B><CODE>hasMoveTo</CODE></B>. This is an iterative directive providing
    0 or 1 iterations. When provided, it indicates that the path has
    a section that starts at a specific point whose coordinates are the
    values of the <CODE>x0</CODE> and <CODE>y0</CODE> directives.
  <LI><B><CODE>hasLineTo</CODE></B>. This is an iterative directive providing
    0 or 1 iterations. When provided, it indicates that the current
    segment is a straight line ending at a new current point whose
    coordinates are given by the values of the <CODE>x0</CODE>
    and <CODE>y0</CODE> directives.
  <LI><B><CODE>hasQuadTo</CODE></B>. This is an iterative directive
    providing 0 or 1 iterations. When provided, it indicates that the
    current segment is a quadratic B&eacute;zier curve whose
    first control point is given by the values of the <CODE>x0</CODE>
    and <CODE>y0</CODE> directives, and whose final point (the new
    current point) is given by the values of the  <CODE>x1</CODE>
    and <CODE>y1</CODE> directives.
  <LI><B><CODE>hasCubicTo</CODE></B>. This is an iterative directive
    providing 0 or 1 iterations. When provided, it indicates that
    current segment is a cubic B&eacute;zier curve whose first control
    point is given by the values of the <CODE>x0</CODE>
    and <CODE>y0</CODE> directives, whose second control point is
    given by the values of the <CODE>x1</CODE> and <CODE>y1</CODE>
    directives, and whose final point (the new current point) is given
    by the values of the <CODE>x2</CODE> and <CODE>y2</CODE>
    directives.
  <LI><B><CODE>x0</CODE></B>. This directive, when present, gives the
    X coordinate for a point that is either the starting point
    provided for a <CODE>SEG_MOVETO</CODE> operation, the ending point
    for a <CODE>SEG_LINETO</CODE> operation, or the first control
    point for a <CODE>SEG_QUADTO</CODE> or <CODE>SEG_CUBICTO</CODE>
    operation.
  <LI><B><CODE>y0</CODE></B>. This directive, when present, gives the Y
    coordinate for a point that is either the starting point provided
    for a <CODE>SEG_MOVETO</CODE> operation, the ending point for a
    <CODE>SEG_LINETO</CODE> operation, or the first control point for a
    <CODE>SEG_QUADTO</CODE> or <CODE>SEG_CUBICTO</CODE> operation.
  <LI><B><CODE>x1</CODE></B> This directive, when present, gives the X
    coordinate for a point that is either the final point for
    a <CODE>SEG_QUADTO</CODE> operation of the second control point
    for a <CODE>SEG_CUBICTO</CODE> operation.
  <LI><B><CODE>y1</CODE></B>. This directive, when present, gives the Y
    coordinate for a point that is either the final point for
    a <CODE>SEG_QUADTO</CODE> operation of the second control point
    for a <CODE>SEG_CUBICTO</CODE> operation.
  <LI><B><CODE>x2</CODE></B>. This directive, when present, gives the X
    coordinate for a point that is the final point for a
    <CODE>SEG_CUBICTO</CODE> operation.
  <LI><B><CODE>y2</CODE></B>. This directive, when present, gives the Y
    coordinate for a point that is the final point for a
    <CODE>SEG_CUBICTO</CODE> operation.
</UL>
In addition, as an alternative to the directives
<CODE>hasClose</CODE>, <CODE>hasMoveTo</CODE>, <CODE>hasLineTo</CODE>,
<CODE>hasQuadTo</CODE>, and <CODE>hasCubicTo</CODE>, one may use
the following directives:
<UL>
  <LI><B><CODE>has0</CODE></B> This is an iterative directive with 1
     iteration that indicates that the directives <CODE>x0</CODE>
     and <CODE>y0</CODE> have non-empty values.
  <LI><B><CODE>has1</CODE></B> This is an iterative directive with 1
     iteration that indicates that the directives <CODE>x1</CODE>
     and <CODE>y1</CODE> have non-empty values.
  <LI><B><CODE>has2</CODE></B> This is an iterative directive with 1
     iteration that indicates that the directives <CODE>x2</CODE>
     and <CODE>y2</CODE> have non-empty values.
</UL>

<H1><A name="cli">The command-line interface</A></H1>

EPTS can be as a window-system-based program or as a command-line
program.  The command-line capabilities allow EPTS to be used (for
example) in a Makefile, where it will generate files in user-specified
formats. Meanwhile, EPTS's GUI can be used to edit a saved state.
Options that generate files use the <CODE>-o</CODE> flag to set
the name of the output file, with <CODE>-</CODE> indicating
standard output.
<P>
If the <CODE>epts</CODE> command is run with no arguments, the program
will open a dialog box asking for the name of an image file to open.
This file will provide a background image that will appear in the
program's main window. For example, on a Linux system, one can type
<CODE>epts</CODE> as a command:
<BR>
<BR>
<CENTER><IMG src="terminal.png"></CENTER>
<BR>
This will bring up a dialog box asking for an image file:
<BR>
<BR>
<CENTER><IMG src="dialog.png"></CENTER>
<BR>
If the epts command is run with a single argument, the name of an EPTS
file, the program will restore its state to the state that existed
when this EPTS file was created (typically by saving a previous
session).  Usually a computer's window system will be configured so
that one can simply double-click the EPTS file rather than having to
run a specific command:
<BR>
<CENTER><IMG src="filewindow.png"></CENTER>
An EPTS file's name must end with the extension <CODE>epts</CODE>.
<P>
When run from the command line, a number of additional options are
available beyond the trivial case supported by the GUI. If the JVM has
to be configured (e.g., to provide more memory or to include
additional class libraries), the CLI must be used to start the
program.
<P>
There are three options that do not fit into well-defined categories:
<UL>
  <LI><CODE>--</CODE>. This option simply indicates the end of
    options, and is provided in case a file name starts with a
    "<CODE>-</CODE>".
  <LI><CODE>--image</CODE>. This option implies that there will be one
    file argument specifying the name of an image file.
  <LI><CODE>--port</CODE> <EM>PORT</EM>.  When this flag is used, it
    sets the TCP port number for an embedded web server that will
    provide the on-line manual. The port number <EM>PORT</EM> must be
    a valid TCP port number (1 to 65535 inclusive, but some ports are
    reserved or require system privileges).
  <LI><CODE>--script</CODE> <EM>A2D</EM>. This option indicates that
    the file arguments are files containing scripts that will be
    run using a scripting language.  The argument <EM>A2D</EM>
    is the name of a scripting-language variable whose value is an
    instance of the class <CODE>org.bzdev.anim2d.Animation2D</CODE>.
    It will be used to produce an image by creating a snapshot of
    the objects that are currently defined in the animation and that
    are visible. The scripts will configure this object. The
    constructor for <CODE>Animation2D</CODE> will determine the size of
    the image.
</UL>
If neither of the options <CODE>--image</CODE>
or <CODE>--script</CODE> are present, there should be one file
argument that provides the name of a file containing a saved state. By
convention, this file should end with the file-name extension
<CODE>epts</CODE> (for example, "<CODE>saved.epts</CODE>").

<H2><A name="scriptOptions">Scripting Options</A></H2>

The options specific to the EPTS command when scripting is used
directly are the following:
<UL>
  <LI><CODE>--double</CODE> <EM>NAME</EM><CODE>=</CODE><EM>DVALUE</EM>.The
    argument consists of two parts. <EM>NAME</EM> is the name of a
    scripting-language variable and <EM>DVALUE</EM> is a real number
    that provides the corresponding value for that variable. The
    variable will be set before any script is run.
  <LI><CODE>--height</CODE> <EM>HEIGHT</EM>. The height in points for
    an image with one pixel per point that represents a drawing surface.
    If not provided, a default of 1024 will be used.
  <LI><CODE>--int</CODE> <EM>NAME</EM><CODE>=</CODE><EM>IVALUE</EM>. The
    argument consists of two parts. <EM>NAME</EM> is the name of a
    scripting-language variable and <EM>IVALUE</EM> is an integer that
    provides the corresponding value for that variable. The variable
    will be set before any script is run.
  <LI><CODE>--string</CODE> <EM>NAME</EM><CODE>=</CODE><EM>SVALUE</EM>. The
    argument consists of two parts. <EM>NAME</EM> is the name of a
    scripting-language variable and <EM>SVALUE</EM> is a string that
    provides the corresponding value for that variable. The variable
    will be set before any script is run.
  <LI><CODE>--width></CODE> <EM>WIDTH</EM>. The width in points for
    an image with one pixel per point that represents a drawing surface.
    If not provided, a default of 1024 will be used.
</UL>
The options above should not be used when a saved state is restore.
Some <code>scrunner</code> options may also be appropriate for
scripting: the <CODE>-L</CODE> option allows the scripting language to
be explicitly configured (otherwise the language will be guessed from
file-name extensions), and the <CODE>--codebase</CODE> option will
allow other class libraries to be used in addition to the BZDev class
library that is loaded by default.  For security reasons, a saved
state does not include the codebase: instead, the codebase must be
explicitly specified on the command line.

<H2><A name="templateOptions">Template Options</A></H2>

The options specific to the EPTS command when templates are used are:
<UL>
  <LI><CODE>--elevate</CODE>. This option applies when the
    <CODE>--pname</CODE> option is set and is ignored otherwise. When
    set, the degree of linear and quadratic B&eacute;zier curve
    segments will be elevated so that all segments are cubic
    B&eacute;zier curve segments.
  <LI><CODE>--fill</CODE> <EM>COLOR</EM>. This option sets
    the <CODE>fill</CODE> attribute to <EM>COLOR</EM> in an SVG
    path. It applies to a path specified by the
    next <CODE>--pname</CODE> option.  The value of
    <EM>COLOR</EM> can be any color specification accepted by SVG (the
    same as those defined by the CSS2 specification).  A value of none
    indicates that no color is specified and the path will not be
    filled. Named colors are listed at
    &lt;https://upload.wikimedia.org/wikipedia/commons/2/2b/SVG_Recognized_color_keyword_names.svg&gt;.
    A <CODE>#</CODE> followed immediately by 6 hexadecimal digits
    gives the RGB values (two hexadecimal digits in that order). One
    can also use the
    expression <CODE>rgb(</CODE><EM>R</EM><CODE>,</CODE><EM>G</EM><CODE>,</CODE><EM>B</EM><CODE>)</CODE>
    where <EM>R</EM> , <EM>B</EM> , and <EM>G</EM> vary from 0 to 255
    or 0% to 100%.
  <LI><CODE>--fill-rule</CODE> <EM>RULE</EM>. This option sets the
    <CODE>fill-rull</CODE> attribute to <EM>RULE</EM> in an SVG path.
    It applies to a path specified by the next <CODE>--pname</CODE>
    option.  <EM>RULE</EM> may be the constants <CODE>nonzero</CODE>
    or <CODE>evenodd</CODE>.
  <LI><CODE>--flatness</CODE> <EM>FLATNESS</EM>. This option applies when
    the <CODE>--pname</CODE> option is set and is ignored otherwise.
    When <EM>FLATNESS</EM> is zero, the <CODE>--limit</CODE> option
    determines the number of times a segment will be partitioned.
    Otherwise control points must deviate from a straight line along
    each segment by at most the value of <EM>FLATNESS</EM>.
  <LI><CODE>--gcs</CODE>. This option applies when the
    <CODE>--pname</CODE> option is set and is ignored otherwise, but may
    not be used with the <CODE>--svg</CODE> option. When
    present, it indicates that coordinates will be in GCS units. Otherwise
    user-space or image space units are used.
  <LI><CODE>--limit</CODE> <EM>LIMIT</EM>.
  <LI><CODE>--map</CODE> <EM>MAPFILE</EM>.
    The file <EM>MAPFILE</EM> is a text file (UTF-8 encoded) whose
    entries are a series of lines. Each line contains a token
    that is the name of an enumeration constant whose type is
    org.bzdev.geom.SplinePathBuilder.CPointType, followed by
    whitespace separating that token from its replacement value.
    Any trailing whitespace will be removed from the replacement.
    Valid token values are <CODE>MOVE_TO</CODE>, <CODE>SPLINE</CODE>,
    <CODE>CONTROL</CODE>, <CODE>SEG_END</CODE>, or <CODE>CLOSE</CODE>.
    In templates, the tokens become the value for <CODE>$(type)</CODE>
    and the replacements become the value for <CODE>$(atype)</CODE>.
    If a mapping is not defined, the replacement is the same as the
    original. The argument <EM>MAPFILE</EM> can be either a file
    name or a URL. If the file named is a relative file, the name
    is resolved using the current working directory when EPTS started.
    This may not be the current working directory while EPTS is
    running as the current working directory may be changed when an
    EPTS file (one with a .epts extension) is processed.  If
    <EM>MAPFILE</EM> starts with the string "sresource:",
    "file:", "http:", "https:", or "ftp", then <EM>MAPFILE</EM> is
    assumed to be a URL pointing to the object to read.
  <LI><CODE>-o</CODE> <EM>OUTFILE</EM>.  This option specifies the
    name of the output file for template processing.  If it is a
    relative file, it will be resolved against the current working
    directory that existed when EPTS was started.  If the file name is
    "-", the output will be sent to standard output.
  <LI><CODE>--pname</CODE> <EM>PNAME</EM>. This option selects a
    variable name, <EM>PNAME</EM>, that must match the name of a path.
    It is used with templates that use the
    <A href="#pitemplates">path-iterator format</A>. When the
    <CODE>--svg</CODE> option is not used, there may be at most one
    <CODE>--pname</CODE> option. When the <CODE>--svg</CODE> option is
    used, there may be multiple <CODE>--pname</CODE> options. In
    either case, case<EM>PNAME</EM> may consist of an identifier,
    immediately followed by a ":", in turn followed by a series of
    comma-separated path names.  This in effect creates a path with a
    new name that is a concatenation of paths specified in EPTS's
    table. The main use of this variant is to create shapes that may
    have holes in them.  When the <CODE>--svg</CODE> option is present
    (this option must precede all <CODE>--pname</CODE> options),the
    attributes <CODE>--fill</CODE>, <CODE>--fillRule</CODE>,
    <CODE>--stroke</CODE>, and <CODE>--stroke-width</CODE> that are
    used are the ones between the current <CODE>--pname</CODE> option
    and any preceding <CODE>--pname</CODE> option, or the start of the
    command if there is no preceding <CODE>--pname</CODE> option.
    After a <CODE>--pname</CODE> these fill and stroke options are
    reset to their defaults for use by following <CODE>--pname</CODE>
    options.
  <LI><CODE>--straight</CODE>.  This option applies when the
    <CODE>--pname</CODE> option is set and is ignored otherwise.
    When set, the selected path will be flattened and converted to
    straight-line segments.
  <LI><CODE>--stroke</CODE> <EM>COLOR</EM>.  This option sets the
    stroke attribute to <EM>COLOR</EM> in an SVG path.  It applies
    to a path specified by the next <CODE>--pname</CODE> option. The
    value of <EM>COLOR</EM> can be any color specification accepted
    by SVG (the same as those defined by the CSS2 specification). A
    value of none indicates that no color is specified and the path
    will not be drawn. Named colors are listed at
    &lt;https://upload.wikimedia.org/wikipedia/commons/2/2b/SVG_Recognized_color_keyword_names.svg&gt;.
    A <CODE>#</CODE> followed immediately by 6 hexadecimal digits
    gives the RGB values (two hexadecimal digits in that order). One
    can also use the
    expression <CODE>rgb(</CODE><EM>R</EM><CODE>,</CODE><EM>G</EM><CODE>,</CODE><EM>B</EM><CODE>)</CODE>
    where <EM>R</EM> , <EM>B</EM> , and <EM>G</EM> vary from 0 to
    255 or 0% to 100%.
  <LI><CODE>--stroke-width</CODE> <EM>WIDTH</EM>.  This option sets
    the <CODE>stroke-width</CODE> attribute to <EM>WIDTH</EM> in an
    SVG path. It applies to a path specified by the next
    <CODE>--pname</CODE> option.  The value of <EM>WIDTH</EM> is any
    width acceptable to SVG: a number possibly followed by a unit
    or a '%' symbol.
  <LI><CODE>--svg</CODE> This option, if present, must precede all
    <CODE>--pname</CODE> options.  It indicates that the output will
    be an SVG (Scaleable Vector Graphics) file.
    The <CODE>--template</CODE>, <CODE>--flatness</CODE>,
    <CODE>--straigth</CODE>, and/or <CODE>--elevate</CODE> options
    must not be used with this option.  The option <CODE>-o</CODE> is
    required and at least one <CODE>--pname</CODE> option should be
    present. The options <CODE>--fill</CODE>, <CODE>--fillRule</CODE>,
    <CODE>--stroke</CODE>, and <CODE>--stroke-width</CODE> may be
    used (at least one  will typically be provided).
  <LI><CODE>--template:</CODE><EM>RESOURCE</EM>.
    This option is a shortcut that behaves like the option
    <CODE>--template sresource:</CODE><EM>RESOURCE</EM>.
  <LI><CODE>--template</CODE> <EM>TFILE</EM>. This option may not be
    used with the <CODE>--svg</CODE> option.  When <EM>TFILE</EM>
    starts with the string "sresource:", "file:", "http:", "https:",
    or "ftp", <EM>TFILE</EM> is assumed to be a URL. Otherwise is is
    assumed to be the name of a file.  The syntax of a template is
    describe in the section of this manual entitled
    "<A href="#templates">Templates</A>". For the
    <CODE>sresource</CODE> protocol, the template is embedded in the
    EPTS application.  and these are described above in the section
    describing <A href="#builtins">built-in templates</A>. The supported
    table templates are <CODE>sresource:ECMAScriptLayers</CODE>,
    <CODE>sresource:ECMAScriptLocations</CODE>,
    <CODE>sresource:ECMAScriptPaths</CODE>, and
    <CODE>sresource:ECMAScript</CODE>. These must be used without
    the <CODE>--pname</CODE> option. Supported path-iterator templates
    are <CODE>sresource:area</CODE>, <CODE>sresource:circumference</CODE>,
    <CODE>sresource:pathlength</CODE>, and <CODE>sresource:SegmentsCSV</CODE>.
    These must be used with the <CODE>--pname</CODE> option.
  <LI><CODE>--tname</CODE> <EM>TNAME</EM> This option's
    argument <EM>TNAME</EM> provides the name of a variable that names
    a path.  When this option is provided, a table template must be
    used and the keymap is the table keymap as described by the manual
    page <CODE>epts(5)</CODE> and by the on-line manual for
    <CODE>epts</CODE>. <EM>TNAME</EM> may be an existing identifier for
    a path or a location in an EPTS table, or it may consist of an
    identifier, immediately followed by a ":", in turn followed by a
    series of comma-separated path names.  This in effect creates a
    path with a new name that is a concatenation of paths specified
    in EPTS's table. Before each <CODE>--tname</CODE> option, there
    may be a <CODE>--windingRule</CODE> option.
  <LI><CODE>--web</CODE>. The <CODE>--port</CODE> option should also be
    used to provide a non-zero port number. This option will start
    an embedded web server allowing the manual to be shown.
  <LI><CODE>--windingRule</CODE> <EM>RULE</EM>.  This option, when
    present, adds a winding rule for use with table templates when
    the <CODE>--tname</CODE>option is used, and must precede that
    option. After a <CODE>--tname</CODE>option is seen, the winding
    rule removed.  The values of <EM>RULE</EM> may be
    <CODE>evenodd</CODE> or <EM>nonzero</EM>, the same names as used
    by the <CODE>--fillRule</CODE> option that is used with the
    <CODE>--svg</CODE> option. The <CODE>--windingRule</CODE> option
    sets a template-table keymap directive as described in the
    documentation for <CODE>epts</CODE>(5) and in the on-line
    manual. It is an error to use this option when a
    <CODE>--tname</CODE> option is not present or when this option
    does not precede a <CODE>--tname</CODE> option.
  <LI><CODE>--</CODE>. End of options. This can be used
    if file names start with the character '-'. Otherwise
    it is not necessary.
</UL>

<H2><A name="scrunner">Scrunner options</A></H2>

There are a set of command-line options that are the same as those
provided by the scrunner command. These are
<UL>
  <LI><CODE>--cosebase</CODE> <EM>SPEC</EM>.
    This option allows additional code bases to be available to the
    JVM. Any number of <CODE>--codebase</CODE> options may be
    provided, and each option can contain multiple code bases
    with the character '|' used as a separator. A code base is specified
    by either a URL or a path name of a file in (local) file system.
    If there is a ':' in the file name and the preceding characters are
    consistent with a protocol name in a URL, the file name will be treated
    as a URL. In this case, use a "file:" URL to specify the code base.
    Several characters are treated specially. A leading "~" followed by
    the name separator ("/" for Unix) is expanded to the user's home
    directory. A file name consisting only of "~" is replaced with the
    user's home directory. A leading "~~" is replaced with "~", and
    a leading "..." followed by the name separator ("/" for Unix) is
    replaced by the directory in which the EPTS program's JAR
    file is located. This will typically be the same directory as
    the BZDev class library's JAR file. If an EPTS session is saved,
    the saved file will not contain the files and directories provided
    by the <CODE>--codebase</CODE> options for security reasons.
  <LI><CODE>-D</CODE><EM>NAME</EM><CODE>=</CODE><EM>VALUE</EM>.
    This option defines a system property whose name is <EM>Name</EM>
    and whose value is <EM>VALUE</EM>.
  <LI><CODE>--dryrun</CODE>. This options simply prints the java
    command that will be used to start the JVM and run the program.
    It is useful primarily for debugging.
  <LI><CODE>-J</CODE><EM>OPTION</EM>. The string <EM>OPTION</EM>
    is turned into an option passed to the 'java' command used
    to start the JVM. It can be used, for example, to increase the
    memory available to the JVM. If the option starts with a leading
    '-', that must be provided explicitly.
  <LI><CODE>-L</CODE> <EM>LNAME</EM>.
    When scripting is used, this option explicitly indicates a
    scripting language. <CODE>ECMAScript</CODE> is always supported.
</UL>

<H2><A name="examples">CLI Examples</A></H2>
<UL>
  <LI><CODE>epts saved.epts</CODE>
    <BR>
    Start EPTS, restoring its state to one saved in a previous session.
  <LI><CODE>epts --codebase foo.jar saved.epts</CODE>
    <BR>
    Start EPTS, restoring its state to one saved in a previous session,
    adding a jar file <CODE>foo.jar</CODE> to EPTS's code base.
  <LI><CODE>epts --image image.png</CODE>
    <BR>
    Start EPTS with an image preloaded as its
    background.
  <LI><CODE>epts --script a2d commands.js</CODE>
    <BR>
    Start EPTS and run the script provided in commands.js to generate
    an image from an animation <CODE>a2d</CODE> (an instance of
    <CODE>org.bzdev.anim2d.Animation2D</CODE>).
  <LI><CODE>epts --codebase foo.jar --script a2d commands.js</CODE>
    <BR>
    Start EPTS and run the script provided in commands.js to generate
    an image from an animation <CODE>a2d</CODE> (an instance of
    <CODE>org.bzdev.anim2d.Animation2D</CODE>). The file foo.jar contains
    additional classes needed by the script. The <CODE>--codebase</CODE>
    option will be needed when restarting EPTS using a saved state
    created when this command is being run.
  <LI><CODE>epts -o out.js --template:ECMAScript saved.epts</CODE>
    <BR>
    Run EPTS without a GUI to generate a file <CODE>out.js</CODE>
    containing a series of ECMAScript statements containing the contents
    of the EPTS table.
  <LI><CODE>epts -o out.svg --svg --fill red --pname s:c1,c2 saved.epts</CODE>
    <BR>
    Run EPTS without a GUI to generate an SVG file <CODE>out.svg</CODE>
    containing a shape <CODE>s</CODE>consisting of two curves
    (<CODE>c1</CODE> and <CODE>c2</CODE>) defined in the EPTS table.
    The table is the one defined by the file <CODE>saved.epts</CODE>
  <LI><CODE>epts -o - --gcs --template:area -pname s:c1,c2</CODE>
    <BR>
    Run EPTS without a GUI to compute the area of a shape bounded
    by the curves <CODE>c1</CODE> and <CODE>c2</CODE>. The area is
    in GCS units.
</UL>


</BODY>
</HTML>
<!--  LocalWords:  EPTS PoinTS BZDev anim zier ECMA GCS JRE Runtime
 -->
<!--  LocalWords:  overlayed scrollbars whitespace varname Makefile
 -->
<!--  LocalWords:  pathSegment EPTS's epts MAPFILE UTF sresource http
 -->
<!--  LocalWords:  https TFILE OUTFILE Scrunner scrunner JVM LNAME js
 -->
<!--  LocalWords:  Makefiles URI NaN CSV TCP DVALUE IVALUE SVALUE SVG
 -->
<!--  LocalWords:  codebase CSS RGB PNAME Scaleable AnimationPath CLI
 -->
<!--  LocalWords:  DFactory TNAME keymap preloaded
 -->
